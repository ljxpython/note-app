# ğŸ¤– AIæœåŠ¡æ¶æ„è®¾è®¡
## AI Service Architecture

**æœåŠ¡åç§°**: AI Service  
**åˆ›å»ºæ—¥æœŸ**: 2025-01-17  
**BMad Master**: AI BMad Master  
**æœåŠ¡èŒè´£**: DeepSeeké›†æˆã€å†…å®¹ä¼˜åŒ–ã€æ™ºèƒ½åˆ†ç±»  

---

## ğŸ¯ æœåŠ¡æ¦‚è¿°

### æ ¸å¿ƒèŒè´£
- **å†…å®¹ä¼˜åŒ–**: æ–‡æœ¬è¯­æ³•å’Œè¡¨è¾¾ä¼˜åŒ–
- **æ™ºèƒ½ç»­å†™**: åŸºäºä¸Šä¸‹æ–‡çš„å†…å®¹ç»­å†™
- **è‡ªåŠ¨åˆ†ç±»**: å†…å®¹ä¸»é¢˜è¯†åˆ«å’Œåˆ†ç±»
- **å¯¹è¯äº¤äº’**: å¤šè½®AIå¯¹è¯å’Œå»ºè®®
- **é£æ ¼å­¦ä¹ **: ç”¨æˆ·å†™ä½œé£æ ¼å­¦ä¹ å’Œé€‚åº”

### ä¸šåŠ¡è¾¹ç•Œ
- âœ… **åŒ…å«**: AIæ¨¡å‹è°ƒç”¨ã€å†…å®¹åˆ†æã€æ™ºèƒ½å»ºè®®
- âŒ **ä¸åŒ…å«**: ç”¨æˆ·ç®¡ç†ã€ç¬”è®°å­˜å‚¨ã€åˆ†äº«é€»è¾‘

---

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æœåŠ¡æ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    AI Service                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Optimizationâ”‚ â”‚ Classificationâ”‚ â”‚ Conversation      â”‚ â”‚
â”‚ â”‚ Controller  â”‚ â”‚ Controller   â”‚ â”‚ Controller        â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Text        â”‚ â”‚ Content     â”‚ â”‚ Style Learning      â”‚ â”‚
â”‚ â”‚ Optimizer   â”‚ â”‚ Classifier  â”‚ â”‚ Engine              â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ DeepSeek    â”‚ â”‚ Prompt      â”‚ â”‚ Cache               â”‚ â”‚
â”‚ â”‚ Client      â”‚ â”‚ Manager     â”‚ â”‚ Manager             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Request     â”‚ â”‚ Response    â”‚ â”‚ Analytics           â”‚ â”‚
â”‚ â”‚ Queue       â”‚ â”‚ Cache       â”‚ â”‚ Storage             â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          Redis + MongoDB + PostgreSQL                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ
- **æ¡†æ¶**: Node.js + Express.js + TypeScript
- **AIé›†æˆ**: DeepSeek API + OpenAI SDK
- **é˜Ÿåˆ—**: Bull Queue + Redis
- **ç¼“å­˜**: Redis (å¤šå±‚ç¼“å­˜)
- **æ•°æ®åº“**: MongoDB (AIä¼šè¯) + PostgreSQL (é…é¢ç®¡ç†)
- **ç›‘æ§**: Prometheus + Custom Metrics

---

## ğŸ”Œ DeepSeek APIé›†æˆ

### APIå®¢æˆ·ç«¯è®¾è®¡
```typescript
interface DeepSeekClient {
  // æ–‡æœ¬ä¼˜åŒ–
  optimizeText(request: OptimizationRequest): Promise<OptimizationResponse>
  
  // å†…å®¹ç»­å†™
  continueText(request: ContinuationRequest): Promise<ContinuationResponse>
  
  // å†…å®¹åˆ†ç±»
  classifyContent(request: ClassificationRequest): Promise<ClassificationResponse>
  
  // å¯¹è¯äº¤äº’
  chatCompletion(request: ChatRequest): Promise<ChatResponse>
}

class DeepSeekService implements DeepSeekClient {
  private apiKey: string
  private baseURL: string
  private rateLimiter: RateLimiter
  private circuitBreaker: CircuitBreaker
  
  constructor(config: DeepSeekConfig) {
    this.apiKey = config.apiKey
    this.baseURL = config.baseURL
    this.rateLimiter = new RateLimiter(config.rateLimit)
    this.circuitBreaker = new CircuitBreaker(config.circuitBreaker)
  }
  
  async optimizeText(request: OptimizationRequest): Promise<OptimizationResponse> {
    // 1. è¯·æ±‚éªŒè¯å’Œé¢„å¤„ç†
    await this.validateRequest(request)
    
    // 2. é™æµæ£€æŸ¥
    await this.rateLimiter.checkLimit(request.userId)
    
    // 3. ç¼“å­˜æ£€æŸ¥
    const cacheKey = this.generateCacheKey('optimize', request)
    const cached = await this.cache.get(cacheKey)
    if (cached) return cached
    
    // 4. æ„å»ºPrompt
    const prompt = this.buildOptimizationPrompt(request)
    
    // 5. APIè°ƒç”¨ (å¸¦ç†”æ–­å™¨)
    const response = await this.circuitBreaker.execute(() => 
      this.callDeepSeekAPI(prompt)
    )
    
    // 6. å“åº”å¤„ç†å’Œç¼“å­˜
    const result = this.processOptimizationResponse(response)
    await this.cache.set(cacheKey, result, 1800) // 30åˆ†é’Ÿç¼“å­˜
    
    return result
  }
}
```

### Promptå·¥ç¨‹
```typescript
class PromptManager {
  // æ–‡æœ¬ä¼˜åŒ–Promptæ¨¡æ¿
  buildOptimizationPrompt(request: OptimizationRequest): string {
    const { text, optimizationType, userStyle } = request
    
    return `ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æ–‡æœ¬ä¼˜åŒ–åŠ©æ‰‹ã€‚è¯·ä¼˜åŒ–ä»¥ä¸‹æ–‡æœ¬ï¼š

åŸæ–‡ï¼š
${text}

ä¼˜åŒ–è¦æ±‚ï¼š
- ç±»å‹ï¼š${optimizationType} (grammar/expression/structure)
- ç”¨æˆ·é£æ ¼ï¼š${userStyle || 'é€šç”¨'}
- ä¿æŒåŸæ„ä¸å˜
- æä¾›å…·ä½“çš„æ”¹è¿›å»ºè®®

è¯·è¿”å›JSONæ ¼å¼ï¼š
{
  "optimizedText": "ä¼˜åŒ–åçš„æ–‡æœ¬",
  "suggestions": [
    {
      "type": "grammar|expression|structure",
      "original": "åŸå§‹ç‰‡æ®µ",
      "optimized": "ä¼˜åŒ–ç‰‡æ®µ", 
      "explanation": "ä¼˜åŒ–è¯´æ˜"
    }
  ],
  "confidence": 0.95
}`
  }
  
  // å†…å®¹åˆ†ç±»Promptæ¨¡æ¿
  buildClassificationPrompt(request: ClassificationRequest): string {
    const { content, existingCategories } = request
    
    return `è¯·åˆ†æä»¥ä¸‹å†…å®¹å¹¶è¿›è¡Œåˆ†ç±»ï¼š

å†…å®¹ï¼š
${content}

ç°æœ‰åˆ†ç±»ï¼š
${existingCategories.map(cat => `- ${cat.name}: ${cat.description}`).join('\n')}

è¯·è¿”å›JSONæ ¼å¼ï¼š
{
  "suggestions": [
    {
      "categoryName": "åˆ†ç±»åç§°",
      "confidence": 0.92,
      "reasoning": "åˆ†ç±»ç†ç”±"
    }
  ],
  "detectedTopics": ["ä¸»é¢˜1", "ä¸»é¢˜2"],
  "keyPhrases": ["å…³é”®è¯1", "å…³é”®è¯2"]
}`
  }
}
```

---

## ğŸ“Š æ•°æ®æ¨¡å‹è®¾è®¡

### AIè¯·æ±‚è®°å½•
```sql
-- AIè¯·æ±‚è®°å½•è¡¨ (PostgreSQL)
CREATE TABLE ai_requests (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL,
    request_type VARCHAR(50) NOT NULL, -- 'optimize', 'continue', 'classify', 'chat'
    input_text TEXT NOT NULL,
    input_length INTEGER NOT NULL,
    model_used VARCHAR(50) NOT NULL,
    tokens_used INTEGER,
    processing_time_ms INTEGER,
    cost_cents INTEGER, -- æˆæœ¬ï¼ˆåˆ†ï¼‰
    status VARCHAR(20) DEFAULT 'pending', -- 'pending', 'completed', 'failed'
    error_message TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    completed_at TIMESTAMP
);

-- ç”¨æˆ·AIé…é¢è¡¨
CREATE TABLE user_ai_quotas (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL UNIQUE,
    plan_type VARCHAR(20) NOT NULL DEFAULT 'free', -- 'free', 'premium', 'team'
    monthly_limit INTEGER NOT NULL DEFAULT 50,
    monthly_used INTEGER DEFAULT 0,
    daily_limit INTEGER NOT NULL DEFAULT 10,
    daily_used INTEGER DEFAULT 0,
    reset_date DATE NOT NULL,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

### AIä¼šè¯æ•°æ® (MongoDB)
```javascript
// AIå¯¹è¯ä¼šè¯é›†åˆ
const conversationSchema = {
  _id: ObjectId,
  userId: String,
  noteId: String, // å…³è”çš„ç¬”è®°ID
  sessionId: String,
  messages: [{
    role: String, // 'user' | 'assistant'
    content: String,
    timestamp: Date,
    metadata: {
      tokens: Number,
      model: String,
      processingTime: Number
    }
  }],
  context: {
    noteContent: String, // ç¬”è®°ä¸Šä¸‹æ–‡
    userStyle: String,   // ç”¨æˆ·å†™ä½œé£æ ¼
    previousOptimizations: [String] // ä¹‹å‰çš„ä¼˜åŒ–è®°å½•
  },
  status: String, // 'active' | 'completed' | 'expired'
  createdAt: Date,
  updatedAt: Date,
  expiresAt: Date
}

// ç”¨æˆ·é£æ ¼å­¦ä¹ æ•°æ®
const userStyleSchema = {
  _id: ObjectId,
  userId: String,
  styleProfile: {
    formalityLevel: Number,    // æ­£å¼ç¨‹åº¦ 0-1
    sentenceLength: String,    // 'short' | 'medium' | 'long'
    vocabularyLevel: String,   // 'simple' | 'advanced' | 'technical'
    tone: String,             // 'professional' | 'casual' | 'academic'
    preferredStructure: String // 'linear' | 'hierarchical' | 'narrative'
  },
  learningData: [{
    optimizationType: String,
    userChoice: String,      // 'accept' | 'reject' | 'modify'
    originalText: String,
    optimizedText: String,
    userModification: String,
    timestamp: Date
  }],
  confidence: Number,        // é£æ ¼è¯†åˆ«ç½®ä¿¡åº¦
  lastUpdated: Date,
  createdAt: Date
}
```

---

## ğŸ”„ è¯·æ±‚å¤„ç†æµç¨‹

### å¼‚æ­¥å¤„ç†æ¶æ„
```typescript
// è¯·æ±‚é˜Ÿåˆ—å¤„ç†
class AIRequestProcessor {
  private optimizationQueue: Queue
  private classificationQueue: Queue
  private conversationQueue: Queue
  
  constructor() {
    this.optimizationQueue = new Queue('text-optimization', {
      redis: redisConfig,
      defaultJobOptions: {
        removeOnComplete: 100,
        removeOnFail: 50,
        attempts: 3,
        backoff: 'exponential'
      }
    })
    
    this.setupQueueProcessors()
  }
  
  private setupQueueProcessors() {
    // æ–‡æœ¬ä¼˜åŒ–å¤„ç†å™¨
    this.optimizationQueue.process('optimize-text', 5, async (job) => {
      const { userId, text, options } = job.data
      
      try {
        // 1. é…é¢æ£€æŸ¥
        await this.checkUserQuota(userId, 'optimize')
        
        // 2. å†…å®¹é¢„å¤„ç†
        const processedText = this.preprocessText(text)
        
        // 3. AIè°ƒç”¨
        const result = await this.deepSeekService.optimizeText({
          text: processedText,
          ...options
        })
        
        // 4. åå¤„ç†
        const finalResult = this.postprocessOptimization(result)
        
        // 5. é…é¢æ›´æ–°
        await this.updateUserQuota(userId, 'optimize', 1)
        
        return finalResult
      } catch (error) {
        await this.handleProcessingError(error, job)
        throw error
      }
    })
  }
}
```

### ç¼“å­˜ç­–ç•¥
```typescript
class AICache {
  private redis: Redis
  
  // å¤šå±‚ç¼“å­˜ç­–ç•¥
  async get(key: string): Promise<any> {
    // L1: å†…å­˜ç¼“å­˜ (æœ€å¿«)
    const memoryResult = this.memoryCache.get(key)
    if (memoryResult) return memoryResult
    
    // L2: Redisç¼“å­˜ (å¿«)
    const redisResult = await this.redis.get(key)
    if (redisResult) {
      const parsed = JSON.parse(redisResult)
      this.memoryCache.set(key, parsed, 300) // 5åˆ†é’Ÿå†…å­˜ç¼“å­˜
      return parsed
    }
    
    return null
  }
  
  async set(key: string, value: any, ttl: number): Promise<void> {
    // åŒæ—¶è®¾ç½®å†…å­˜å’ŒRedisç¼“å­˜
    this.memoryCache.set(key, value, Math.min(ttl, 300))
    await this.redis.setex(key, ttl, JSON.stringify(value))
  }
  
  // ç¼“å­˜é”®ç”Ÿæˆç­–ç•¥
  generateCacheKey(type: string, request: any): string {
    const hash = crypto.createHash('md5')
      .update(JSON.stringify({
        type,
        text: request.text,
        options: request.options
      }))
      .digest('hex')
    
    return `ai:${type}:${hash}`
  }
}
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### è¯·æ±‚ä¼˜åŒ–
```typescript
// æ‰¹é‡å¤„ç†ä¼˜åŒ–
class BatchProcessor {
  private batchSize = 10
  private batchTimeout = 2000 // 2ç§’
  private pendingRequests: Map<string, PendingRequest[]> = new Map()
  
  async processBatch(type: string, requests: any[]): Promise<any[]> {
    // å°†å¤šä¸ªç›¸ä¼¼è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªæ‰¹é‡è¯·æ±‚
    const batchPrompt = this.buildBatchPrompt(type, requests)
    const batchResponse = await this.deepSeekService.batchProcess(batchPrompt)
    
    // æ‹†åˆ†æ‰¹é‡å“åº”ä¸ºå•ç‹¬çš„ç»“æœ
    return this.splitBatchResponse(batchResponse, requests.length)
  }
}

// æ™ºèƒ½é¢„åŠ è½½
class PreloadManager {
  async preloadUserStyle(userId: string): Promise<void> {
    // é¢„åŠ è½½ç”¨æˆ·å†™ä½œé£æ ¼æ•°æ®
    const styleData = await this.getUserStyle(userId)
    await this.cache.set(`user:style:${userId}`, styleData, 3600)
  }
  
  async preloadCommonOptimizations(): Promise<void> {
    // é¢„åŠ è½½å¸¸è§ä¼˜åŒ–æ¨¡å¼
    const commonPatterns = await this.getCommonOptimizationPatterns()
    for (const pattern of commonPatterns) {
      await this.cache.set(`pattern:${pattern.id}`, pattern, 7200)
    }
  }
}
```

### æˆæœ¬æ§åˆ¶
```typescript
class CostManager {
  // æ™ºèƒ½é…é¢ç®¡ç†
  async checkAndAllocateQuota(userId: string, requestType: string): Promise<boolean> {
    const quota = await this.getUserQuota(userId)
    const cost = this.calculateRequestCost(requestType)
    
    if (quota.remaining < cost) {
      // é…é¢ä¸è¶³ï¼Œæ£€æŸ¥æ˜¯å¦å¯ä»¥ä½¿ç”¨å¤‡ç”¨ç­–ç•¥
      return await this.tryFallbackStrategy(userId, requestType)
    }
    
    await this.deductQuota(userId, cost)
    return true
  }
  
  // æˆæœ¬é¢„æµ‹
  async estimateRequestCost(request: any): Promise<number> {
    const textLength = request.text.length
    const complexity = this.analyzeComplexity(request.text)
    
    // åŸºäºæ–‡æœ¬é•¿åº¦å’Œå¤æ‚åº¦ä¼°ç®—tokenä½¿ç”¨é‡
    const estimatedTokens = Math.ceil(textLength * 1.3 * complexity)
    return this.tokensToCredits(estimatedTokens)
  }
}
```

---

## ğŸ§ª æµ‹è¯•ç­–ç•¥

### å•å…ƒæµ‹è¯•
```typescript
describe('AIService', () => {
  describe('optimizeText', () => {
    it('should optimize text successfully', async () => {
      const request = {
        text: 'è¿™ä¸ªç®—æ³•çš„æ•ˆç‡ä¸æ˜¯å¾ˆå¥½',
        optimizationType: 'expression',
        userId: 'test-user-id'
      }
      
      const result = await aiService.optimizeText(request)
      
      expect(result.optimizedText).toBeDefined()
      expect(result.suggestions).toHaveLength(1)
      expect(result.confidence).toBeGreaterThan(0.8)
    })
    
    it('should handle quota exceeded', async () => {
      // æµ‹è¯•é…é¢è¶…é™æƒ…å†µ
    })
  })
})
```

### é›†æˆæµ‹è¯•
- DeepSeek APIé›†æˆæµ‹è¯•
- ç¼“å­˜ç³»ç»Ÿæµ‹è¯•
- é˜Ÿåˆ—å¤„ç†æµ‹è¯•
- é…é¢ç®¡ç†æµ‹è¯•

---

## ğŸ“Š ç›‘æ§æŒ‡æ ‡

### ä¸šåŠ¡æŒ‡æ ‡
- **AIä½¿ç”¨ç‡**: ç”¨æˆ·AIåŠŸèƒ½ä½¿ç”¨é¢‘ç‡
- **å»ºè®®é‡‡çº³ç‡**: ç”¨æˆ·é‡‡çº³AIå»ºè®®çš„æ¯”ä¾‹
- **ç”¨æˆ·æ»¡æ„åº¦**: AIå»ºè®®è´¨é‡è¯„åˆ†
- **é…é¢ä½¿ç”¨**: å„ç”¨æˆ·ç¾¤ä½“çš„é…é¢ä½¿ç”¨æƒ…å†µ

### æŠ€æœ¯æŒ‡æ ‡
- **APIå“åº”æ—¶é—´**: DeepSeek APIè°ƒç”¨å»¶è¿Ÿ
- **å¤„ç†ååé‡**: æ¯ç§’å¤„ç†çš„AIè¯·æ±‚æ•°
- **ç¼“å­˜å‘½ä¸­ç‡**: å„çº§ç¼“å­˜çš„å‘½ä¸­ç‡
- **é”™è¯¯ç‡**: AIè¯·æ±‚å¤±è´¥ç‡
- **æˆæœ¬æ•ˆç‡**: æ¯æ¬¡è¯·æ±‚çš„å¹³å‡æˆæœ¬

---

## ğŸš€ éƒ¨ç½²é…ç½®

### Dockeré…ç½®
```dockerfile
FROM node:18-alpine
WORKDIR /app

# å®‰è£…ä¾èµ–
COPY package*.json ./
RUN npm ci --only=production

# å¤åˆ¶æºç 
COPY . .

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3002/health || exit 1

EXPOSE 3002
CMD ["npm", "start"]
```

### ç¯å¢ƒå˜é‡
```env
# DeepSeeké…ç½®
DEEPSEEK_API_KEY=your-deepseek-api-key
DEEPSEEK_BASE_URL=https://api.deepseek.com
DEEPSEEK_MODEL=deepseek-chat

# ç¼“å­˜é…ç½®
REDIS_URL=redis://redis:6379
CACHE_TTL_OPTIMIZATION=1800
CACHE_TTL_CLASSIFICATION=3600

# é˜Ÿåˆ—é…ç½®
QUEUE_CONCURRENCY=5
QUEUE_MAX_ATTEMPTS=3

# é…é¢é…ç½®
FREE_USER_MONTHLY_LIMIT=50
PREMIUM_USER_MONTHLY_LIMIT=1000
```

---

**æœåŠ¡çŠ¶æ€**: âœ… æ¶æ„è®¾è®¡å®Œæˆ  
**å¼€å‘å°±ç»ªåº¦**: ğŸš€ 90% - éœ€è¦DeepSeek APIå¯†é’¥é…ç½®  
**ç›¸å…³Story**: Story 1.1.1, 1.1.2, 1.2.1 éƒ½ä¾èµ–æ­¤æœåŠ¡
